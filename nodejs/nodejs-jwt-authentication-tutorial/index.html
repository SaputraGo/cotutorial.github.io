<!DOCTYPE html>
<html lang="id-ID">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width">
    <meta name="google-site-verification" content="o0UedRQqZULbVZPe6SPx1VD1YxJd6WL-2-15-XHWS1g" />
    <meta name="msvalidate.01" content="479C48823705295AF4454A1704545592" />
    <meta name="description" content="Hundreds of free tutorials for cutting edge languages and frameworks."> 
    <meta name="author" content="Wisnu Saputra">
    <meta property="og:site_name" content="CoTutorial" />

    <title>NodeJS JWT Authentication Tutorial | CoTutorial</title>


    <link rel="icon" type="image/png" href="https://images.tutorialedge.net/images/favicon.ico">
    <link media="all" defer rel="stylesheet" href="https://use.typekit.net/jnu8xif.css">
    <link media="all" defer href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link media="all" defer rel="stylesheet" href="https://cotutorial.github.io//css/style.css">  <meta name="generator" content="Hugo 0.57.2" />
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>
    <script src="../../js/jquery-3.4.1.slim.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js" integrity="sha384-xrRywqdh3PHs8keKZN+8zzc5TX0GRTLCcmivcbNJWm2rs5C8PRhcEn3czEjhAO9o" crossorigin="anonymous"></script>
    <meta content='100023577212451' property='fb:admins'/>
    <meta content="493615514813695" property="fb:app_id"/>

</head>

<body>
    <div id="dynamicApp">
        <nav class="navbar navbar-expand-lg">
            
            <a class="navbar-brand" href="../../">
                <img alt="tutorialedge logo" src="../../images/svg/logo.svg" alt="CoTutorial">
                <span>CoTutorial</span>
            </a>
            

            
            <button class="navbar-toggler text-white" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
			<img src="../../images/svg/hamburger.svg" alt="hamburger menu" />
		</button>
            

            <div class="collapse navbar-collapse justify-content-between" id="navbarSupportedContent">
                <ul class="navbar-nav mr-auto">
                    
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="courseDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
							Courses
						</a>
                        <div class="dropdown-menu" aria-labelledby="courseDropdown">
                            <a class="dropdown-item" href="https://cotutorial.github.io//course/artificial-intelligence/"><img alt="AI logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/ai.png" />AI</a>
                            <a class="dropdown-item" href="https://cotutorial.github.io//course/angular/"><img alt="angular logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/angular.svg" />Angular</a>
                            <a class="dropdown-item" href="https://cotutorial.github.io//course/cloud/"><img alt="cloud logo" src="data:image/png.svg;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/cloud.svg" />Cloud</a>
                            <a class="dropdown-item" href="https://cotutorial.github.io//course/compsci/"><img alt="computer science" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="../../images/svg/logo.svg" />Computer Science</a>
                            <a class="dropdown-item" href="https://cotutorial.github.io//course/python/"><img alt="python logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/python.svg" />Python</a>
                            <a class="dropdown-item" href="https://cotutorial.github.io//course/golang/"><img alt="golang logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/golang.svg" />Golang</a>
                            <a class="dropdown-item" href="https://cotutorial.github.io//course/rust/"><img alt="rust logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/rust-logo.png" />Rust</a>
                            <a class="dropdown-item" href="https://cotutorial.github.io//course/vuejs/"><img alt="vuejs logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/vuejs.svg" />VueJS</a>
                            <a class="dropdown-item" href="https://cotutorial.github.io//course/webdev/"><img alt="webdev logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="../../images/svg/logo.svg" />Web Dev
                            </a>
                        </div>
                    </li>
                    

                    
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="courseDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						Projects
					</a>
                        <div class="dropdown-menu" aria-labelledby="courseDropdown">
                            <a class="dropdown-item" href="https://cotutorial.github.io//projects/hacker-news-clone-vuejs/"><img alt="VueJS logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/vuejs.svg" />HackerNews Clone in VueJS</a>
                            <a class="dropdown-item" href="https://cotutorial.github.io//projects/building-blog-with-vuejs-aws/"><img alt="VueJS logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/vuejs.svg" />Building a VueJS Blog on AWS</a>
                            <a class="dropdown-item" href="https://cotutorial.github.io//projects/chat-system-in-go-and-react/"><img alt="VueJS logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/golang.svg" />Building a Chat Application in Go and React</a>
                        </div>
                    </li>
                    

                    
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="tutorialDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						Tutorials
					</a>
                        <div class="dropdown-menu dropdown-menu-mega" aria-labelledby="tutorialDropdown">
                            <div class="row">
                                <div class="col-sm-6">
                                    <a class="dropdown-item" href="https://cotutorial.github.io//artificial-intelligence/"><img alt="AI logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/ai.png" /> AI</a>
                                    <a class="dropdown-item" href="https://cotutorial.github.io//typescript/angular/"><img alt="Angular logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/angular.svg" />Angular</a>
                                    <a class="dropdown-item" href="https://cotutorial.github.io//javascript/angularjs/"><img alt="AngularJS logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/logos/angularjs.svg" /> AngularJS</a>
                                    <a class="dropdown-item" href="https://cotutorial.github.io//cloud/"><img alt="Cloud logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/cloud.svg" /> Cloud</a>
                                    <a class="dropdown-item" href="https://cotutorial.github.io//compsci/"><img alt="Comp Sci logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="../../images/svg/logo.svg" /> Comp Sci</a>
                                    <a class="dropdown-item" href="https://cotutorial.github.io//docker/"><img alt="Docker logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/docker.svg" /> Docker</a>
                                    <a class="dropdown-item" href="https://cotutorial.github.io//gamedev/"><img alt="GameDev logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="../../images/svg/logo.svg" /> GameDev</a>
                                    <a class="dropdown-item" href="https://cotutorial.github.io//golang/"><img alt="Golang logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/golang.svg" /> Golang</a>
                                </div>
                                <div class="col-sm-6">
                                    <a class="dropdown-item" href="https://cotutorial.github.io//nodejs/"><img alt="Nodejs logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/javascript.svg" /> NodeJS</a>
                                    <a class="dropdown-item" href="https://cotutorial.github.io//python/"><img alt="Python logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/python.svg" /> Python</a>
                                    <a class="dropdown-item" href="https://cotutorial.github.io//rust/"> <img alt="Rust logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/rust-logo.png" /> Rust</a>
                                    <a class="dropdown-item" href="https://cotutorial.github.io//typescript/"><img alt="TypeScript logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/typescript.svg" /> TypeScript</a>
                                    <a class="dropdown-item" href="https://cotutorial.github.io//javascript/vuejs/"><img alt="VueJS logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/vuejs.svg" /> VueJS</a>
                                    <a class="dropdown-item" href="https://cotutorial.github.io//webdev/"><img alt="Web Dev logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="../../images/svg/logo.svg" /> Web Dev</a>
                                </div>
                            </div>
                        </div>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../../blog/">Blog</a>
                    </li>
                    
                </ul>


                
                <ul class="navbar-nav full-height">
                    <li class="nav-item">
                        <a class="nav-link search" href="../../search"><img src="../../images/svg/search.svg" alt="search icon" style="width:15px; height: 15px;" /> Search</a>
                    </li>
                    <Signup/>
                </ul>
                

            </div>
        </nav>

        
        <nav class="navbar secondary-nav navbar-expand-lg navbar-light bg-light">

            
            <button class="navbar-toggler text-white" type="button" data-toggle="collapse" data-target="#secondNav" aria-controls="secondNav" aria-expanded="false" aria-label="Toggle navigation">
	   <img src="../../images/svg/hamburger.svg" alt="hamburger menu" />
   </button>

            <div class="collapse navbar-collapse justify-content-between" id="secondNav">
                <ul class="navbar-nav mr-auto">

                    
                    <li class="nav-item">
                        <a class="nav-link" href="https://cotutorial.github.io//course/angular/"><img alt="angular logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/angular.svg" /> Angular</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://cotutorial.github.io//course/cloud/"><img alt="cloud logo" src="data:image/png.svg;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/cloud.svg" /> Cloud</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://cotutorial.github.io//course/python/"><img alt="python logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/python.svg" />Python</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://cotutorial.github.io//course/golang/"><img alt="golang logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/golang.svg" />Golang</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://cotutorial.github.io//course/rust/"><img alt="rust logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/rust-logo.png" />Rust</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="https://cotutorial.github.io//course/vuejs/"><img alt="vuejs logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/vuejs.svg" />VueJS</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://cotutorial.github.io//course/webdev/"><img alt="webdev logo" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="../../images/svg/logo.svg" />Web Dev</a>
                    </li>
                </ul>
            </div>
        </nav>

<div class="top-bar">
    <div class="container">
        <h1>
            
            <img src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="https://images.tutorialedge.net/images/node.png" alt="NodeJS JWT Authentication Tutorial Image" />  NodeJS JWT Authentication Tutorial
        </h1>
        <div class="post-info">
            <div class="post-info-inner">
                <span>
            
            <img class="author" src="../../images/svg/logo.svg" alt="CoTutorial" />
            
            <a href="https://twitter.com/Elliot_F">CoTutorial</a>
          </span>

                <span><img class="icon" src="https://tutorialedge.net/images/svg/clock.svg" alt="clock"/>8 Minutes</span>
                <span><img class="icon" src="https://tutorialedge.net/images/svg/calendar.svg" alt="clock"/> May 25, 2019</span>

                <span>
            
            <a href="../../tags/Authentication"
              ><span class="badge badge-pill badge-info">Authentication</span></a>
                
                </span>
            </div>
        </div>
    </div>
</div>

<div class="container-fluid">
    <div class="content-container">
        <div class="row">

            <div class="d-none d-sm-none col-sm-3 d-md-block">
                <div class="sidebar">
                    <div id="sidebar small-no-show">

  <div class="right-sidebar youtube-subscribe">
    <h3>Site Sponsors</h3>
    <a href="#"><img class="patron" src="https://images.tutorialedge.net/images/DigitalOcean.png" style="width: 100%; height: auto; margin: 0; " alt="Amazing Site Sponsors!"/></a>
    <hr/>
    <h3>Support The Site</h3>
    <a href="#"><img class="patron" src="https://images.tutorialedge.net/images/patreon.png" alt="become a patron"/></a>
    <div class="clear"></div>
    <a href="#"><img src="https://www.buymeacoffee.com/assets/img/custom_images/orange_img.png" alt="Buy Me A Coffee" style="height: auto !important;width: auto !important;" ></a>
  </div>


  <div class="right-sidebar small-no-show">
    

    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    

    
    

    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    

    
    <h4 style="text-transform: uppercase;">authentication</h4>
    <ul class="collection">
      
      
      <li class="collection-item"><a href="https://cotutorial.github.io/nodejs/nodejs-jwt-authentication-tutorial/">NodeJS JWT Authentication Tutorial</a></li>
      
      
    </ul>
    
    

    
    
    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    

    
    

    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    

    
    

    
    
    
    

    
    

    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    

    
    

    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    

    
    <h4 style="text-transform: uppercase;">csv</h4>
    <ul class="collection">
      
      
      <li class="collection-item"><a href="https://cotutorial.github.io/nodejs/converting-csv-json-node/">Converting CSV to JSON using NodeJS</a></li>
      
      
    </ul>
    
    

    
    
    
    
    
    
    
    

    
    

    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    

    
    

    
    
    
    

    
    

    
    
    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    

    
    <h4 style="text-transform: uppercase;">expressjs</h4>
    <ul class="collection">
      
      
      <li class="collection-item"><a href="https://cotutorial.github.io/nodejs/creating-a-webserver-with-nodejs/">Building a Webserver using ExpressJS and NodeJS</a></li>
      
      
    </ul>
    
    

    
    
    
    
    
    
    
    
    
    

    
    <h4 style="text-transform: uppercase;">file-system</h4>
    <ul class="collection">
      
      
      <li class="collection-item"><a href="https://cotutorial.github.io/nodejs/reading-writing-files-with-nodejs/">Reading and Writing Files With NodeJS</a></li>
      
      
    </ul>
    
    

    
    
    
    

    
    

    
    
    
    
    
    
    
    

    
    

    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    

    
    

    
    
    
    
    
    

    
    

    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
    

    
    

    
    
    
    

    
    

    
    
    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    

    
    

    
    
    
    
    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    

    
    <h4 style="text-transform: uppercase;">javascript</h4>
    <ul class="collection">
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <li class="collection-item"><a href="https://cotutorial.github.io/nodejs/nodejs-404-checker-tutorial/">NodeJS 404 Checker Tutorial</a></li>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <li class="collection-item"><a href="https://cotutorial.github.io/nodejs/keeping-node-apps-running-forever-pm2/">Keeping NodeJS Applications Running Forever Using PM2</a></li>
      
      
      
      
      
      
      
      <li class="collection-item"><a href="https://cotutorial.github.io/nodejs/creating-a-webserver-with-nodejs/">Building a Webserver using ExpressJS and NodeJS</a></li>
      
      
      
      <li class="collection-item"><a href="https://cotutorial.github.io/nodejs/executing-shell-scripts-with-nodejs/">Executing Shell Scripts With NodeJS</a></li>
      
      
      
      <li class="collection-item"><a href="https://cotutorial.github.io/nodejs/creating-deleting-directories-with-nodejs/">Creating and Deleting Directories With NodeJS</a></li>
      
      
      
      <li class="collection-item"><a href="https://cotutorial.github.io/nodejs/editing-xml-files-with-nodejs/">Editing XML Files With NodeJS</a></li>
      
      
      
      <li class="collection-item"><a href="https://cotutorial.github.io/nodejs/converting-csv-json-node/">Converting CSV to JSON using NodeJS</a></li>
      
      
      
      <li class="collection-item"><a href="https://cotutorial.github.io/general/building-software-using-microservice-architecture/">Building Software using A Microservice Based Architecture</a></li>
      
      
      
      <li class="collection-item"><a href="https://cotutorial.github.io/nodejs/writing-your-own-logging-system-nodejs/">Writing Your Own Logging System NodeJS</a></li>
      
      
      
      <li class="collection-item"><a href="https://cotutorial.github.io/nodejs/monitoring-server-stats-with-nodejs/">Monitoring Server Stats With NodeJS</a></li>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
    </ul>
    
    

    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    

    
    <h4 style="text-transform: uppercase;">json</h4>
    <ul class="collection">
      
      
      
      
      <li class="collection-item"><a href="https://cotutorial.github.io/nodejs/converting-csv-json-node/">Converting CSV to JSON using NodeJS</a></li>
      
      
    </ul>
    
    

    
    
    
    

    
    

    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    

    
    

    
    
    
    

    
    

    
    
    
    

    
    

    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    

    
    

    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    

    
    <h4 style="text-transform: uppercase;">pm2</h4>
    <ul class="collection">
      
      
      <li class="collection-item"><a href="https://cotutorial.github.io/nodejs/keeping-node-apps-running-forever-pm2/">Keeping NodeJS Applications Running Forever Using PM2</a></li>
      
      
    </ul>
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    

    
    

    
    
    
    
    
    

    
    

    
    
    
    

    
    

    
    
    
    
    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    

    
    

    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    

    
    

    
    
    
    

    
    

    
    
    
    

    
    

    
    
    
    
    
    
    
    

    
    

    
    
    
    
    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    

    
    

    
    
    
    
    
    

    
    

    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    

    
    

    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    

    
    <h4 style="text-transform: uppercase;">unix</h4>
    <ul class="collection">
      
      
      <li class="collection-item"><a href="https://cotutorial.github.io/nodejs/executing-shell-scripts-with-nodejs/">Executing Shell Scripts With NodeJS</a></li>
      
      
    </ul>
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    

    
    

    
    
    
    
    
    

    
    

    
    
    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    

    
    <h4 style="text-transform: uppercase;">xml</h4>
    <ul class="collection">
      
      
      <li class="collection-item"><a href="https://cotutorial.github.io/nodejs/editing-xml-files-with-nodejs/">Editing XML Files With NodeJS</a></li>
      
      
    </ul>
    
    
  </div>

</div>
                </div>
            </div>

            <div class="col-sm-9 col-md-7">
                <article class="content" v-pre>
                    

<p>Welcome fellow programmers! In this tutorial, we are going to be looking at how we can add authentication to our NodeJS applications using JWTs.</p>

<p>We&rsquo;ll be creating a REST API that feature a mixture of authenticated and un-authenticated JSON endpoints and we&rsquo;ll be implementing a nice and simple JWT validation function that will verify incoming requests to ensure they have the appropriate authorization header set and that the value of that header is a verified JSON Web Token!</p>

<h1 id="goals">Goals</h1>

<p>By the end of this tutorial, we will have covered the following:</p>

<ul>
<li>We will have created a really simple REST API using ExpressJS</li>
<li>We will understand how we can create middleware functions that we can wrap endpoints with.</li>
<li>We will understand how to add JWT Authentication to these middleware functions to ensure only authorized requestors can hit our REST API endpoints.</li>
</ul>

<h1 id="prerequisites">Prerequisites</h1>

<p>In order to complete this tutorial, you will need to have the following:</p>

<ul>
<li>NodeJS installed on your machine</li>
<li>A Text Editor (I recommend Visual Studio Code)</li>
</ul>

<h1 id="video-tutorial">Video Tutorial</h1>

<p>This tutorial is available in video format if you prefer:</p>


<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="//www.youtube.com/embed/0g0Of8jlhN8" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>


<h1 id="introduction">Introduction</h1>

<p>Being able to verify who is hitting your API endpoints is incredibly important. It allows you to determine if the requestor is an authorized person who is allowed to actually interact with your service.</p>

<p>This is where JWT authentication can solve our problems. We can create use JWTs in combination with request headers to help us validate that an incoming request is authorized or not.</p>

<h1 id="jwts-or-json-web-tokens">JWTs or JSON Web Tokens</h1>

<p>JWTs or a JSON Web Token, to use its full name, is a means of representing claims between two parties.</p>

<h2 id="structure">Structure</h2>

<p>A typical JWT features a Header, a Payload, and a Signature.</p>

<p><img src="https://images.tutorialedge.net/node/node-jwt-authentication-tutorial/jwt-structure.svg" alt="JWT Structure" /></p>

<p>Let&rsquo;s break down what each of these is used for:</p>

<ul>
<li><strong>The Header</strong> - This contains metadata about the JWT such as the type of token and the cryptographic algorithm used to secure it.</li>
<li><strong>The Payload</strong> - This is the <em>set of claims</em> contained within the JWT that contains a series of key/value pairs. The payload can be read by anyone, so ensure that you don&rsquo;t add any confidential to the payload.</li>
<li><strong>The Signature</strong> - This is used to validate that everything in the JWT has not been tampered with in any way and is generated using the header, the payload and a signing key or passphrase.</li>
</ul>

<p>In this tutorial, we are going to be creating JWTs that feature an incredibly simple payload. We&rsquo;ll be then signing any JWTs we create using a private RSA key.</p>

<p>This private RSA key is <em>only</em> known by the server issuing any JWTs used and thus, unless a bad actor gets a hold of this key, it&rsquo;s almost impossible to generate a JWT token that will have a valid signature.</p>

<h1 id="a-basic-rest-api">A Basic REST API</h1>

<p>Now that we have covered the theory, let&rsquo;s set about creating a simple REST API in NodeJS that uses Express.JS. Create a new directory in which our project will live and run the following:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-output" data-lang="output">$ npm init</code></pre></div>
<p>Keep everything as default values for now, we can edit this later should we need to.</p>

<p>Now that we have initialized our project, we&rsquo;ll need to install the express.js Node Module:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-output" data-lang="output">$ npm install express --save</code></pre></div>
<p>This will go away and fetch the required express node module which we&rsquo;ll be using to construct the REST API that we will be securing.</p>

<blockquote>
<p><strong>Note</strong> - We are using Express here in this particular example, but the concepts in this tutorial are framework-agnostic and can be used with other web application frameworks such as Koa.</p>
</blockquote>

<p>Now that we have all of our dependencies installed, we can go ahead and write some code! Create a new file within your project directory called <code>index.js</code>.</p>

<div class="filename"> index.js </div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">express</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;express&#39;</span>)
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">app</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">express</span>()
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">port</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">3000</span>

<span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;/&#39;</span>, (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">send</span>(<span style="color:#e6db74">&#39;Hello World!&#39;</span>))
<span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">listen</span>(<span style="color:#a6e22e">port</span>, 
    () =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`Simple Express app listening on port </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">port</span><span style="color:#e6db74">}</span><span style="color:#e6db74">!`</span>))
</code></pre></div>
<p>This is an incredibly simple application that returns <code>Hello World!</code> whenever you hit the <code>/</code> path on port <code>3000</code>. You can subsequently start this application like so:</p>

<div class="filename"> $ node index.js </div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-output" data-lang="output">Example app listening on port 3000!</code></pre></div>
<p>With this now running, navigate to <code>http://localhost:3000/</code> in your browser and you will see your application returning the expected <code>Hello World!</code> back to you.</p>

<h1 id="adding-a-few-endpoints">Adding a few Endpoints</h1>

<p>Now that we have a basic NodeJS application up and running on port 3000, let&rsquo;s look at how we can extend this and add a few endpoints which we can subsequently protect.</p>

<p>I&rsquo;m going to keep this super simple for now so that we can focus on the JWT authorization and not the underlying application.</p>

<p>Open up your <code>index.js</code> file once again. Let&rsquo;s add a few new <code>HTTP GET</code> endpoints:</p>

<div class="filename"> index.js </div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">express</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;express&#39;</span>)
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">app</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">express</span>()
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">port</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">3000</span>

<span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;/&#39;</span>, (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">send</span>(<span style="color:#e6db74">&#39;Hello World!&#39;</span>))

<span style="color:#75715e">// let&#39;s first add a /secret api endpoint that we will be protecting
</span><span style="color:#75715e"></span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;/secret&#39;</span>, (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {
    <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">json</span>({ <span style="color:#e6db74">&#34;message&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;THIS IS SUPER SECRET, DO NOT SHARE!&#34;</span> })
})

<span style="color:#75715e">// and a /readme endpoint which will be open for the world to see 
</span><span style="color:#75715e"></span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;/readme&#39;</span>, (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {
    <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">json</span>({ <span style="color:#e6db74">&#34;message&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;This is open to the world!&#34;</span> })
})

<span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">listen</span>(<span style="color:#a6e22e">port</span>, 
    () =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`Simple Express app listening on port </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">port</span><span style="color:#e6db74">}</span><span style="color:#e6db74">!`</span>))
</code></pre></div>
<p>Now that we have these endpoints, let&rsquo;s re-run our application to ensure we haven&rsquo;t broken anything:</p>

<div class="filename"> $ node index.js </div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-output" data-lang="output">Simple Express app listening on port 3000!</code></pre></div>
<p>Let&rsquo;s open up <code>http://localhost:3000/secret</code> in our browser window now that this is up and running. You will see the following response:</p>

<div class="filename"> http://localhost:3000/secret </div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">{
    <span style="color:#e6db74">&#34;message&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;THIS IS SUPER SECRET, DO NOT SHARE!&#34;</span>
}
</code></pre></div>
<p>And when we open up the <code>/readme</code> endpoint, we should see the following:</p>

<div class="filename"> http://localhost:3000/secret </div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">{
    <span style="color:#e6db74">&#34;message&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;This is open to the world!&#34;</span>
}
</code></pre></div>
<p>Perfect, in this step we have been able to add 2 additional endpoints to our application that we will be attempting to protect with JWT validation in the next step of this tutorial.</p>

<h1 id="generating-a-valid-jwt">Generating a Valid JWT</h1>

<p>In this step, we are going to create 1 additional endpoint for our application that will return a valid JWT token for us to test out the authentication in subsequent steps.</p>

<p>In order for us to generate and validate these JWTs, we&rsquo;ll need to first import the <code>jsonwebtoken</code> node module:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-output" data-lang="output">$ npm install --save jsonwebtoken</code></pre></div>
<p>Once we have this node module installed, we can then go ahead and create a custom <code>/jwt</code> endpoint which will create a JWT token for us which features an incredibly simple payload <code>{ &quot;body&quot;: &quot;stuff&quot; }</code> and is signed using a private key that I generated for a deprecated project.</p>

<p>Create a new file within your project direct called <code>private.pem</code> and add the following key:</p>

<div class="filename"> private.pem </div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-output" data-lang="output">-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEAyVTQ9QxfutaYXKBbYfZbH2vhIWoIPEjAFSbsy1PZoIcclUQR
hJ8t2m7v47M8eEyYd7EvXTNdoN6CDs0DoNC9KESATZV5SUVr7sk9pOcMrm0VryAd
h7hQbbHWqyKmOehCt1JdX7gV2i5XnRb5qYQSyoB8sGdfR4SQ9q1XPRIpBP8RYXCP
WPmwnmtzYjfs+VVMp+ByNWgM8Qvyc3Z13tHKHWfTokbEbJJE0xfFG6CVFZy+T7uq
0UxhkWh8tekaDbfrIYtgC8HRHfRPcqvsN/pkJM0DIU4UNIf2TeLARa+iATNiF5IX
DeAAkIqoQL0tgt6S+8HIEPGiQ3gpGE56DON06QIDAQABAoIBAAvIxyJQwxmwjeJ+
EFs/jD3elqLaDflZWMTkLmAIXGik/+tMvKnCl3B9pdTyHMv9z77RxC/0XbqYy4wK
O/ghv7CnscrYwOyk/5hOdyk7zOY4xFgnzRKwmySQkDwcHxasnZsVWxnLMJxAsigj
vCFL9b2cn6/DnTQWclW996k/ct8z5DzodH/O+JyQl2MvLgjtf1OupbNZcjt4kMRP
GS5em5banlycUtPE0NAcS0QXleHLj5BXOp0AyD+PWfzhWcctiK7p+vmwXv6OVtlu
DIiTTOnsjoMq7skfVzRpjmAesllXBb1evwsrVK7cjYefEsVZ5DzOVLNU5Iug3HCf
RnftUAECgYEA6uWhJ9la1VpiYgEai4F61Rxs/MAQzmWVl0NQhPrczLCdRXfhmeBP
w1a4VkCD7FlZq/UuL4bSnU2JINL/enmrfZfdLdQgjY1VgPNki6v4Da9sqi+D17Wb
w863h/X29cukttFgUQdPO66bwsitoNVDsBqyf2hlFWC+rRPovoFA9WkCgYEA22s2
njRgoV6mTTCgXoZMs8unJ2CTd+BuVP1wDVsHR0VnK7blVlIW9Hop0ZmFK3I41kw3
3LXT6RSmZXsdgAsm3VuWlDVFY6t+JUUGYOfZZVNgUX0J597hf2SwxfJ8cgNHuSEO
glxc/dzHXMgamf8+84RCK3NSGP8xmuI/Wm5JE4ECgYEAmFelVTradlTQSc99b8zh
5SUyahoGzFWF1zyJFDW+zeIdndhKMIoSMRYlJ4tgBAFO7v9snNZL8kk/DlLJ7pzK
ZAICKJ7THfrz4VX5d7xofDexug5m65eVFkETNtKHAJK6mPbiCKs87/AmhQWx1gV6
iNRHv+ns5RiBka6/3A3oG0ECgYEAl+qIO0rqaG++1ozHTArSCl4DUlkkYQhLe56p
OSYASRE9WF/eM0DM0eHPGGahdC42OfE1cCOYH7WDa5mtGB0ggHxMKjsj2tk+kpFS
1D9SHjx24JShCiAfonNVjQfRr6KjwwKnKAzI+Z8ljRCikmLN9A5rPegvPE1by++/
i132TIECgYAiDd+OSokfZYi8mqjIoMI946+Hlb7lisb7CXksM69A+oWJrfkCwOMq
O3tExLbxtd7KZuAg1xH2thimIeT6tuCbCSAFGzr4EWCe7iavVzevHr98ivPLYXte
dyWl3YlvqO+SUuieGvHISlekblMO/4tcUscmKmo+FgkMroBsePcdEA==
-----END RSA PRIVATE KEY-----</code></pre></div>
<p>Next, open up your <code>index.js</code> and add the following:</p>

<div class="filename"> index.js </div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">jwt</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;jsonwebtoken&#39;</span>);
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">fs</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;fs&#39;</span>)

<span style="color:#75715e">// ... our other endpoints
</span><span style="color:#75715e"></span>
<span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;/jwt&#39;</span>, (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {
    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">privateKey</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">fs</span>.<span style="color:#a6e22e">readFileSync</span>(<span style="color:#e6db74">&#39;./private.pem&#39;</span>, <span style="color:#e6db74">&#39;utf8&#39;</span>);
    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">token</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">jwt</span>.<span style="color:#a6e22e">sign</span>({ <span style="color:#e6db74">&#34;body&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;stuff&#34;</span> }, <span style="color:#e6db74">&#34;MySuperSecretPassPhrase&#34;</span>, { <span style="color:#a6e22e">algorithm</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;HS256&#39;</span>});
    <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">send</span>(<span style="color:#a6e22e">token</span>);
})


<span style="color:#75715e">// ... the rest of our index.js
</span></code></pre></div>
<p>When we open up <code>http://localhost:3000/jwt</code> in our browser after restarting our application, we should see a valid JSON Web Token returned to us:</p>

<div class="filename"> http://localhost:3000/jwt </div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-output" data-lang="output">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJib2R5Ijoic3R1ZmYiLCJpYXQiOjE1NTg4MTUyMzl9.3Z8G-kCEfr2Xch1FnaEAOeywcVs6aJZ3sbCARybWCgM</code></pre></div>
<p>Awesome, we now have a valid JWT that we can use to test the authentication we are going to be building in the next part of this tutorial!</p>

<h1 id="authentication-middleware">Authentication Middleware</h1>

<p>Let&rsquo;s have a look at the authentication function which will look at an incoming request and parse it for an <code>Authorization</code> header.</p>

<div class="filename"> index.js </div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">isAuthenticated</span>(<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">next</span>) {
    <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">typeof</span> <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">headers</span>.<span style="color:#a6e22e">authorization</span> <span style="color:#f92672">!==</span> <span style="color:#e6db74">&#34;undefined&#34;</span>) {
        <span style="color:#75715e">// retrieve the authorization header and parse out the
</span><span style="color:#75715e"></span>        <span style="color:#75715e">// JWT using the split function
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">token</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">headers</span>.<span style="color:#a6e22e">authorization</span>.<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#34; &#34;</span>)[<span style="color:#ae81ff">1</span>];
        <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">privateKey</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">fs</span>.<span style="color:#a6e22e">readFileSync</span>(<span style="color:#e6db74">&#39;./private.pem&#39;</span>, <span style="color:#e6db74">&#39;utf8&#39;</span>);
        <span style="color:#75715e">// Here we validate that the JSON Web Token is valid and has been 
</span><span style="color:#75715e"></span>        <span style="color:#75715e">// created using the same private pass phrase
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">jwt</span>.<span style="color:#a6e22e">verify</span>(<span style="color:#a6e22e">token</span>, <span style="color:#a6e22e">privateKey</span>, { <span style="color:#a6e22e">algorithm</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;HS256&#34;</span> }, (<span style="color:#a6e22e">err</span>, <span style="color:#a6e22e">user</span>) =&gt; {
            
            <span style="color:#75715e">// if there has been an error...
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">err</span>) {  
                <span style="color:#75715e">// shut them out!
</span><span style="color:#75715e"></span>                <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">status</span>(<span style="color:#ae81ff">500</span>).<span style="color:#a6e22e">json</span>({ <span style="color:#a6e22e">error</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Not Authorized&#34;</span> });
                <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#34;Not Authorized&#34;</span>);
            }
            <span style="color:#75715e">// if the JWT is valid, allow them to hit
</span><span style="color:#75715e"></span>            <span style="color:#75715e">// the intended endpoint
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">next</span>();
        });
    } <span style="color:#66d9ef">else</span> {
        <span style="color:#75715e">// No authorization header exists on the incoming
</span><span style="color:#75715e"></span>        <span style="color:#75715e">// request, return not authorized and throw a new error 
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">status</span>(<span style="color:#ae81ff">500</span>).<span style="color:#a6e22e">json</span>({ <span style="color:#a6e22e">error</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Not Authorized&#34;</span> });
        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#34;Not Authorized&#34;</span>);
    }
}
</code></pre></div>
<p>Now that we have this <code>isAuthorized</code> function, we can update our <code>/secret</code> endpoint to use this function as middleware.</p>

<div class="filename"> index.js </div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;/secret&#39;</span>, <span style="color:#a6e22e">isAuthorized</span>, (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {
    <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">json</span>({ <span style="color:#e6db74">&#34;message&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;THIS IS SUPER SECRET, DO NOT SHARE!&#34;</span> })
})
</code></pre></div>
<p>If we restart our application and try hitting the <code>/secret</code> endpoint once again, we should see the following response:</p>

<div class="filename"> http://localhost:3000/secret </div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">{
    <span style="color:#e6db74">&#34;error&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Not Authorized&#34;</span>
}
</code></pre></div>
<p>Perfect, this has worked exactly as expected and we aren&rsquo;t able to access our <code>/secret</code> endpoint without the appropriate <code>Authorization</code> header set. Let&rsquo;s attempt to hit this endpoint with a <code>curl</code> command, we&rsquo;ll add the <code>Authorization</code> header and set it to <code>jwt</code> along with a valid JWT retrieved from our <code>/jwt</code> endpoint.</p>

<div class="filename"> curl -H "Authorization: jwt <VALID JWT>" http://localhost:3000/secret </div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-output" data-lang="output">{&#34;message&#34;:&#34;THIS IS SUPER SECRET, DO NOT SHARE!&#34;}% </code></pre></div>
<p>Awesome, with this valid JWT in our <code>Authorization</code> header, we&rsquo;ve been able to access the <code>/secret</code> endpoint!</p>

<h1 id="conclusion">Conclusion</h1>

<p>So, in this tutorial, we have managed to create an <code>isAuthenticated</code> middleware function that we can wrap our express API Endpoints with. This <code>isAuthenticated</code> function parses incoming <code>HTTP</code> requests to check if they have the appropriate <code>Authorization</code> header set and then checks to see whether the value of this header is a valid JWT token that has been signed with a specific private key.</p>

<blockquote>
<p><strong>Source Code</strong> - The full source code for this tutorial can be found here: <a href="https://github.com/TutorialEdge/node-jwt-authentication-tutorial">TutorialEdge/node-jwt-authentication-tutorial</a></p>
</blockquote>

<h2 id="further-reading">Further Reading</h2>

<p>If you enjoyed this article, you may also enjoy these other articles:</p>

<ul>
<li><a href="../../nodejs/creating-a-webserver-with-nodejs/">Creating a Web Server with NodeJS</a></li>
<li><a href="https://tools.ietf.org/html/rfc7519">RFC-7519 - JSON Web Tokens</a></li>
</ul>
 
<div class="author-container">
  <div class="author-image">
    
    <img src="../../images/svg/logo.svg" alt="CoTutorial" />
    
  </div>
  <div class="author-info">
    <h2>
      CoTutorial<br />
      <small
        >Twitter: <a href="https://twitter.com/wisnusaputradev">@CoTutorial</a></small
      >
    </h2>
    <p>
      Hey, I'm Elliot and I've been working on TutorialEdge for the last 4 years! If my work has helped you in any way, shape, or form then please consider supporting my work.
    </p>

    <a style="float: left; margin-right: 10px;" href="#"><img class="patron" src="https://images.tutorialedge.net/images/patreon.png" alt="become a patron"/></a>
    <a style="float: left;" href="#"><img src="https://www.buymeacoffee.com/assets/img/custom_images/orange_img.png" alt="Buy Me A Coffee" style="height: auto !important;width: auto !important;" ></a>
    
  </div>
</div>


                </article>
                <div class="comments">
          <div class="content">
    
    
    

    <script>
        function loadAPI() {
            var js = document.createElement('script');
            js.src = '//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v4.0&appId=493615514813695&autoLogAppEvents=1';
            document.body.appendChild(js);
        }
        window.onscroll = function () {
            var rect = document.getElementById('comments').getBoundingClientRect();
            if (rect.top < window.innerHeight) {
                loadAPI();
                window.onscroll = null;
            } 
        }
        </script>
    <div id="fb-root"></div>
    <div class="fb-comments" id="comments" data-href="https://cotutorial.github.io/nodejs/nodejs-jwt-authentication-tutorial/" data-width="100%" data-numposts="5"></div>                  
</div>

        </div>
            </div>

            <div class="col-sm-3 col-md-2">
                <div id="right-sidebar">
                    <div class="toc">
                        <h4>Table Of Contents</h4>
                        <nav id="TableOfContents">
<ul>
<li><a href="#goals">Goals</a></li>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#video-tutorial">Video Tutorial</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#jwts-or-json-web-tokens">JWTs or JSON Web Tokens</a>
<ul>
<li><a href="#structure">Structure</a></li>
</ul></li>
<li><a href="#a-basic-rest-api">A Basic REST API</a></li>
<li><a href="#adding-a-few-endpoints">Adding a few Endpoints</a></li>
<li><a href="#generating-a-valid-jwt">Generating a Valid JWT</a></li>
<li><a href="#authentication-middleware">Authentication Middleware</a></li>
<li><a href="#conclusion">Conclusion</a>
<ul>
<li><a href="#further-reading">Further Reading</a></li>
</ul></li>
</ul>
</nav>
                    </div>
                    <hr/>
                    <div id="codefund">
                        
                    </div>
                    <script src="https://codefund.io/properties/330/funder.js" async="async"></script>
                    <div class="clear"></div>
                </div>
            </div>

        </div>
    </div>
</div>


<script src="../../js/sticky-sidebar.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/anchor-js/3.2.0/anchor.min.js"></script>
<script>
    
    document.addEventListener("DOMContentLoaded", function(event) {
        var sidebar = new StickySidebar("#right-sidebar", {
            topSpacing: 10
        });
        anchors.options = {
            visible: "always",
            placement: "left"
        };
        anchors.add(
            ".content > h1, .content > h2, .content > h3, .content > h4"
        );
    });
</script>


<div class="blue-spacer"></div>

<footer class="page-footer">
    <div class="row">
        <div class="col l3 m6 s12">
            <div class="padded">
                <h3>Courses</h3>
                <ul>
                    <li><a href="https://cotutorial.github.io//python/">Python</a></li>
                    <li><a href="https://cotutorial.github.io//angular/">Angular</a></li>
                    <li><a href="https://cotutorial.github.io//golang/">Golang</a></li>
                    <li><a href="https://cotutorial.github.io//artificial-intelligence/">Artificial Intelligence</a></li>
                    <li><a href="https://cotutorial.github.io//webdev/">Web Development</a></li>
                </ul>
            </div>
        </div>
        <div class="col l3 m6 s12">
            <div class="padded">
                <h3>Quick Links</h3>

                <ul>
                    <li><a href="https://cotutorial.github.io//search/">Search Page</a></li>
                    <li><a href="https://cotutorial.github.io//about/">About</a></li>
                    <li><a href="https://cotutorial.github.io//get-involved/">Get Involved</a></li>
                </ul>
                <h3>Suggested Resources</h3>
                <ul>
                    <li><a href="https://cotutorial.github.io//uses/">My Hardware + Software Recording Setup </a></li>
                </ul>
            </div>
        </div>
        <div class="col l3 m6 s12">
            <div class="padded">
                <h3>Follow Me</h3>
                <ul>
                    <li><a href="https://twitter.com/wisnusaputradev">@wisnusaputradev</a></li>
                    <li><a href="https://www.facebook.com/wisnusaputradev">Wisnu Saputra</a></li>
                    <li><a href="https://github.com/saputrago">saputrago</a></li>
                </ul>
            </div>
        </div>
        <div class="col l3 m12 s12 footer-special">
            <div class="logo">
                <a href="https://cotutorial.github.io//"><img alt="tutorialedge logo" src="../../images/svg/logo.svg" /> CoTutorial</a>
            </div>
            <div class="padded">
                <p>CoTutorial is a totally free programming tutorial site that has been built with the intention of helping as many people as possible learn to program. The site is also completely opensourced and you can contribue here: <a href="https://github.com/saputrago">Project</a>,
                    any pull requests will be greatly appreciated!</p>
            </div>
        </div>
    </div>
    <div class="footer-copyright none">
        <span class="float-left">CoTutorial © 2019 Copyright</span>
        <span class="float-right" id="page-id">fc49a6c3ef89fd3a3ecef5edc59c10a1</span>
    </div>
</footer>



<script async src="https://www.googletagmanager.com/gtag/js?id=UA-10255990-23"></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'UA-10255990-23');
</script>
<script type="text/javascript">
    function init() {
        var imgDefer = document.getElementsByTagName('img');
        
        
        
        
        
        for (var i = 0; i < imgDefer.length; i++) {
            if (imgDefer[i].getAttribute('data-src')) {
                imgDefer[i].setAttribute('src', imgDefer[i].getAttribute('data-src'));
            }
        }

    }

    window.onload = init;
</script>

</div>
</body>

</html>